var INEDITOR=!1;objects={};var world,prefabs={},changing=!1,assetList=new Array,settings={},pausedUpdate=!1,resources={},_loadingBox=void 0,_loadingBoxTick=0,_loadingBox2=void 0;function create(){for(var e in objects)initializeGameObject(objects[e],!1,!0);for(var e in objects){var t=objects[e];warmUpObject(t,!1)}if(document.location.search.startsWith("?reset=")){currentSceneName="";var a=document.location.search.replace("?reset=","");a&&loadScene(a),window.history.pushState("export ","","export.html")}}window.onload=function(){assetList=data.assetList,prefabs=data.prefabs,settings=data.settings,SceneOrder=data.sceneOrder,document.title=settings.Header;for(var e=0;e<assetList.length;e++)assetList[e].name=assetList[e].name.substring(14);var t=data.GO;for(var e in resources.currentScene={data:JSON.stringify(data.GO)},t){var a=t[e];addGameObjectBase(a,!1)}var i=parseInt("0x"+settings.BackgroundColor);game=new PIXI.Application(settings.Height,settings.Width,{antialias:!1,backgroundColor:i}),settings.PixelPerfect&&(PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST),gameContainer=new PIXI.Container,guiContainer=new PIXI.Container,document.getElementById("game").appendChild(game.view),resize();var n=game.renderer.width,r=game.renderer.height;(_loadingBox=new PIXI.Graphics).beginFill(0),_loadingBox.lineStyle(5,11184810),_loadingBox.drawRect(n/6,7*r/16,4*n/6,2*r/16),gameContainer.addChild(_loadingBox),(_loadingBox2=new PIXI.Graphics).beginFill(15658496),_loadingBoxTick=(4*n/6-10)/100,_loadingBox2.drawRect(n/6-5,7*r/16-5,_loadingBoxTick,2*r/16-10),gameContainer.addChild(_loadingBox2),initCanvasActions(),preload(),game.stage.addChild(gameContainer),game.stage.addChild(guiContainer)};var dt=new Date;function update(){try{if(dt=new Date,!pausedUpdate)for(var e in INEDITOR=!1,objects)for(var t in objects[e])if(-1==standartGameObjectProperties.indexOf(t))if(gm[t].prototype.update)try{gm[t].prototype.update.apply(objects[e][t],[16])}catch(e){}else if(objects[e][t].update)try{objects[e][t].update(16)}catch(e){}render(),camera.update(pausedUpdate)}catch(e){}}function render(){for(var e in window.scrollTo(0,0),objects)for(var t in objects[e])objects[e][t].render&&objects[e][t].render()}function preload(){for(var e=0;e<assetList.length;e++)assetList[e].name.endsWith(".js")||PIXI.loader.add(assetList[e].name,"assets/"+assetList[e].name.replace(/\\/g,"/"));if(PIXI.loader.on("progress",function(){_loadingBox2.clear();var e=game.renderer.width,t=game.renderer.height;_loadingBox2.beginFill(15658496),_loadingBox2.drawRect(e/6+5,7*t/16+5,_loadingBoxTick*PIXI.loader.progress,2*t/16-10)}),0<objectToArray(PIXI.loader.resources).length)PIXI.loader.load(function(e,t){_loadingBox2.clear();var a=game.renderer.width,i=game.renderer.height;_loadingBox2.beginFill(15658496),_loadingBox2.drawRect(a/6+5,7*i/16+5,100*_loadingBoxTick,2*i/16-10),requestAnimationFrame(function(){for(var e in t)resources[e]=t[e];for(var e in PIXI.utils.TextureCache)textList[e]=!0;_loadingBox2.clear(),_loadingBox.clear(),gameContainer.removeChild(_loadingBox2),gameContainer.removeChild(_loadingBox),create(),game.ticker.add(update)})});else{for(var e in PIXI.utils.TextureCache)textList[e]=!0;_loadingBox2.clear(),_loadingBox.clear(),gameContainer.removeChild(_loadingBox2),gameContainer.removeChild(_loadingBox),create(),game.ticker.add(update)}}function resize(){resizeGame(),1!=settings.AutoWidth&&1!=settings.AutoHeight||(window.onresize=resizeGame)}function resizeGame(){if(game&&game.view){var e=settings.Height;1==settings.AutoHeight&&(e=window.innerHeight);var t=settings.Width;1==settings.AutoWidth&&(t=window.innerWidth),t/e<settings.MinWidthHeightRatio&&(e=t/settings.MinWidthHeightRatio),t/e>settings.MaxWidthHeightRatio&&(t=e*settings.MaxWidthHeightRatio),game.renderer.resize(t,e)}}function objectToArray(e){var t=[];for(var a in e)t.push(e[a]);return t}