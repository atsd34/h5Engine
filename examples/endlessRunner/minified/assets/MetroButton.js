gm.MetroButton=function(){this.color=9091877,this.text="",this.function="",this.icon="trophy.png",this.sizeX=256,this.sizeY=256,this.action="",this.priorty=99,this.onlyImage=!1,this.turning=void 0},gm.MetroButton.prototype.open=function(t){this.turning=t,this.turning.stepH=(this.turning.height-this.sizeY)/20,this.turning.stepW=(this.turning.width-this.sizeX)/20,this.turning.stepX=(this.turning.x-this.gameObject.position.x)/20,this.turning.stepY=(this.turning.y-this.gameObject.position.y)/20,this.sprite&&(this.turning.stepIW=this.sprite.width/20,this.turning.stepIH=this.sprite.height/20),this.turning.sprite&&(this.turning.imageW=this.turning.sprite.width,this.turning.imageH=this.turning.sprite.height,this.turning.imageWS=this.turning.sprite.width/20,this.turning.imageHS=this.turning.sprite.height/20,this.turning.sprite.width=0,this.turning.sprite.height=0,this.gameObject.position.container.addChild(this.turning.sprite))},gm.MetroButton.prototype.turnStep=function(){if(Math.abs(this.turning.width-this.sizeX)<=Math.abs(this.turning.stepW))return this.sizeX=this.turning.width,this.sizeY=this.turning.height,this.box.clear(),this.box.beginFill(this.color),this.box.lineStyle(0),this.box.zOrder=0,this.box.drawRect(0,0,this.sizeX,this.sizeY),this.gameObject.position.x=this.turning.x,this.gameObject.position.y=this.turning.y,this.sprite&&(this.gameObject.position.container.removeChild(this.sprite),delete this.sprite),this.turning.sprite&&(this.turning.sprite.width=this.turning.imageW,this.turning.sprite.height=this.turning.imageH,this.sprite=this.turning.sprite),!(this.turning=void 0);this.sizeX+=this.turning.stepW,this.sizeY+=this.turning.stepH,this.box.clear(),this.box.beginFill(this.color),this.box.lineStyle(0),this.box.zOrder=0,this.box.drawRect(0,0,this.sizeX,this.sizeY),this.gameObject.position.x+=this.turning.stepX,this.gameObject.position.y+=this.turning.stepY,this.sprite&&(this.sprite.width-=this.turning.stepIW,this.sprite.height-=this.turning.stepIH),this.turning.sprite&&(this.turning.sprite.width+=this.turning.imageWS,this.turning.sprite.height+=this.turning.imageHS)},gm.MetroButton.prototype.create=function(){this.box=new PIXI.Graphics,this.mouseLeft=!0,this.box.zOrder=-1,"alpha"in this?this.box.beginFill(this.color,this.alpha):this.box.beginFill(this.color),this.box.lineStyle(0),this.box.zOrder=0,this.box.drawRect(0,0,this.sizeX,this.sizeY),this.gameObject.position.container.addChild(this.box);var t=new PIXI.TextStyle({fontFamily:"Arial",fontSize:64,fill:[16777215],strokeThickness:0,dropShadow:!1,dropShadowColor:this.dropShadowColor,dropShadowBlur:this.dropShadowBlur,dropShadowAngle:parseFloat(this.dropShadowAngle)*Math.PI/180,dropShadowDistance:parseInt(this.dropShadowDistance)});this.onlyImage||(this.text=new PIXI.Text(this.text,t),this.text.position.x=this.sizeX/2,this.text.position.y=32,this.text.anchor.x=.5,this.text.anchor.y=0,this.text.zOrder=1,this.gameObject.position.container.addChild(this.text)),this.icon&&(this.sprite=new PIXI.Sprite(resources[this.icon].texture),this.sprite.zOrder=2,this.onlyImage?(this.sprite.anchor.x=0,this.sprite.anchor.y=0,this.sprite.position.x=0,this.sprite.position.y=0,this.sprite.width=this.sizeX,this.sprite.height=this.sizeY):(this.sprite.anchor.x=.5,this.sprite.anchor.y=.5,this.sprite.position.x=this.sizeX/2,this.sprite.position.y=this.sizeY/2+this.sprite.height/2-64)),this.sprite&&this.gameObject.position.container.addChild(this.sprite)},gm.MetroButton.prototype.render=function(t){if(this.turning&&this.turnStep(),!this.onlyImage&&this.sprite&&null==this.sprite.rotatable)switch(this.action){case"rotate":this.sprite.rotation>2*Math.PI?(this.sprite.rotation=0,this.action=""):(this.sprite.rotation+=.2,this.sprite.scale.x+=.015,this.sprite.scale.y+=.015);break;case"downrotate":this.sprite.rotation<2*-Math.PI?(this.sprite.rotation=0,this.action=""):this.sprite.rotation-=.2}},gm.MetroButton.prototype.dispose=function(){this.box&&(this.box.clear(),this.gameObject.position.container.removeChild(this.box)),this.text&&this.gameObject.position.container.removeChild(this.text),this.sprite&&this.gameObject.position.container.removeChild(this.sprite)},gm.MetroButton.prototype.mouseMoveOnMe=function(){this.mouseLeft&&(this.action="rotate",this.mouseLeft=!1)},gm.MetroButton.prototype.mouseMove=function(t,i){0==this.mouseLeft&&(this.gameObject.position.isCollidingScreen(i.offsetX,i.offsetY)||(this.mouseLeft=!0,!this.onlyImage&&this.sprite&&null==this.sprite.rotatable&&(this.sprite.rotation=0,this.sprite.scale.x=1,this.sprite.scale.y=1,this.gameObject.position.scaleX=1,this.gameObject.position.scaleY=1),"rotate"==this.action&&(this.action="")))},gm.MetroButton.prototype.mouseDownOnMe=function(t,i){return this.isDown=!0,this.sprite&&(1==this.sprite.scale.x?this.action="rotate":this.action="downrotate"),!0},gm.MetroButton.prototype.mouseUp=function(m,e){this.isDown&&(this.isDown=!1,!this.onlyImage&&this.sprite&&null==this.sprite.rotatable&&(this.sprite.rotation=0,this.action="",this.gameObject.position.scaleX=1,this.gameObject.position.scaleY=1),this.gameObject.position.isCollidingScreen(e.offsetX,e.offsetY)&&this.function&&eval(this.function))};